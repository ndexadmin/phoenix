<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:text="${title}">Activity Log</title>

<!-- Bootstrap 5 -->
<link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    rel="stylesheet">

<style>
body { background-color: #f7f9fc; }

.header-bar {
  background-color: #e6effa;
  padding: 10px 20px;
  border-bottom: 2px solid #d2d9e5;
}

.section-title {
  background-color: #e6effa;
  padding: 10px;
  border-radius: 4px;
  font-weight: bold;
  margin-top: 20px;
  margin-bottom: 15px;
}

.search-box {
  background-color: white;
  padding: 15px;
  border-radius: 4px;
  box-shadow: 0 0 5px rgba(0,0,0,0.05);
}

.results-box { margin-top: 20px; }

/* (même CSS exact que activityAdd.html – ne change rien ici, mais tu voulais identique) */
.table textarea.form-control {
  min-height: 34px;
  height: 34px;
  resize: vertical;
}
</style>
</head>

<body>

    <!-- TOP BAR -->
    <div class="header-bar d-flex justify-content-between align-items-center">
        <div>
            <strong>Back Office</strong> — User:
            <span class="badge bg-secondary">System Administrator</span>
            &nbsp; Organization Unit: <strong>Root Organization</strong>
        </div>
        <div>
            <button class="btn btn-primary btn-sm">USER GUIDE</button>
            <button class="btn btn-primary btn-sm">PORTFOLIO MANAGEMENT</button>
        </div>
    </div>

    <!-- NAVIGATION TABS -->
    <ul class="nav nav-tabs mt-2 px-3">
        <li class="nav-item"><a class="nav-link active" href="#">Activity Log</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Organization Units</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Access Management</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Firm Properties</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Activity Management</a></li>
    </ul>

    <div class="container mt-4">

        <!-- SEARCH TITLE -->
        <div class="section-title">Activity Search</div>

        <!-- SEARCH FORM -->
        <div class="search-box">
            <form method="post"
                  th:action="@{/{product}/{locale}/{firmId}/activity/search(
                      product=${product},
                      locale=${locale},
                      firmId=${firmId}
                  )}"
                  th:object="${searchView}"
                  class="row g-3">

                <!-- CATEGORY -->
                <div class="col-md-3">
                    <label class="form-label">Activity Type</label>
                    <select class="form-select" th:field="*{category}">
                        <option th:each="entry : ${categories}"
                                th:value="${entry.key}"
                                th:text="${entry.value}"></option>
                    </select>
                </div>

                <!-- IMPORTANCE -->
                <div class="col-md-3">
                    <label class="form-label">Importance Level</label>
                    <select class="form-select" th:field="*{importance}">
                        <option th:each="entry : ${importances}"
                                th:value="${entry.key}"
                                th:text="${entry.value}"></option>
                    </select>
                </div>

                <!-- USER ID -->
                <div class="col-md-2">
                    <label class="form-label">User ID</label>
                    <input class="form-control" type="text" th:field="*{userId}">
                </div>

                <!-- FROM DATE -->
                <div class="col-md-2">
                    <label class="form-label">From</label>
                    <input class="form-control" type="date" th:field="*{fromDate}">
                </div>

                <!-- TO DATE -->
                <div class="col-md-2">
                    <label class="form-label">To</label>
                    <input class="form-control" type="date" th:field="*{toDate}">
                </div>

                <!-- DESCRIPTION -->
                <div class="col-md-4">
                    <label class="form-label">Search in Description</label>
                    <input type="text" class="form-control" th:field="*{searchDescription}">
                </div>

                <!-- SEARCH MODE -->
                <div class="col-md-3 d-flex align-items-end">
                    <div class="form-check me-3">
                        <input class="form-check-input" type="radio"
                               th:field="*{searchCriteria}" value="BEGINSWITH">
                        <label class="form-check-label">Begins with</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio"
                               th:field="*{searchCriteria}" value="CONTAINS" checked>
                        <label class="form-check-label">Contains</label>
                    </div>
                </div>

                <!-- BUTTONS -->
                <div class="col-12 text-end">
                    <a class="btn btn-secondary btn-sm"
                       th:href="@{/{product}/{locale}/{firmId}/activity/add(
                           product=${product},
                           locale=${locale},
                           firmId=${firmId}
                       )}">
                        Add New Entry
                    </a>
                    <button type="submit" class="btn btn-primary btn-sm">Search</button>
                </div>

            </form>
        </div>

        <!-- RESULTS -->
        <div class="section-title">
            Search Results
            <button class="btn btn-success btn-sm float-end">EXPORT</button>
        </div>

        <div class="results-box">
            <table class="table table-bordered table-striped">
                <thead class="table-light">
                    <tr>
                        <th>Activity Date</th>
                        <th>Importance Level</th>
                        <th>Activity Type</th>
                        <th>User ID</th>
                        <th>Description</th>
                    </tr>
                </thead>

                <tbody>
                    <tr th:each="item : ${auditItems}">
                        <td th:text="${#temporals.format(item.nDate, 'yyyy/MM/dd - HH:mm:ss')}"></td>
                        <td th:text="${item.importance}"></td>
                        <td th:text="${item.category}"></td>
                        <td th:text="${item.userId}"></td>
                        <td th:text="${item.description}"></td>
                    </tr>

                    <tr th:if="${#lists.isEmpty(auditItems)}">
                        <td colspan="5" class="text-center text-muted">
                            No activity found for the selected criteria
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

</body>
</html>
